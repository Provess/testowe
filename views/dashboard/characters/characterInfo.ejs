<link rel="stylesheet" href="/assets/custom/characterinfo.css">
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1>Informacje o postaci</h1>
  <%if(character_info.faction > 0) { %>
    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
      <form action="/characters/faction/leave?id=<%=character_info.id%>" method="post">
        <button class="btn btn-primary" type="submit"> Opuść frakcję </button>
      </form>
    </h6>

    <%}%>
</div>

<div class="row">
  <div class="col">
    <div class="box p-3 border" style="height: 500px;">
      <div class="d-flex h-100">
        <div class="custom-sidebar bg-dark">
          <ul class="list-group list-group-flush">
            <a href="/characters/info?id=<%=req.query.id%>&type=character">
              <li class="list-group-item">Statystyki</li>
            </a>
            <a href="/characters/info?id=<%=req.query.id%>&type=items">
              <li class="list-group-item">Przedmioty</li>
            </a>
            <a href="/characters/info?id=<%=req.query.id%>&type=vehicles">
              <li class="list-group-item">Pojazdy</li>
            </a>
            <% if(req.session.admin > 0) { %>
              <a href="/characters/info?id=<%=req.query.id%>&type=admin">
                <li class="list-group-item" style="color: red !important;">Panel Administratora</li>
              </a>
              <%}%> 
          </ul>
        </div>
        <div class="main-content flex-grow-1 p-3"  style="overflow: auto;">
          <% if(req.query.type == "character") { %>
            <div class="d-flex flex-wrap" style="height: 100%;">
              <div class="card" style="width: 74%; margin-bottom: 10px; ">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;      background-color: rgb(43, 48, 53) !important; padding: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                  <div style="display: flex; align-items: center;">
                    <i class="fas fa-id-card" style="font-size: 56px; margin-right: 10px; margin-left: 16px;"></i>
                    <div style="display: flex; flex-direction: column;">
                      <h5 class="card-title" style="margin-bottom: 5px; color: white; font-weight: bold; font-size: 18px;"><%=character_info.name%></h5>
                      <p class="card-text" style="margin-bottom: 5px; color: white;">X: <%=character_info.lastx%> Y: <%=character_info.lasty%> Z: <%=character_info.lastz%></p>
                      <p class="card-text" style="margin-bottom: 5px; color: white;">Poziom admina: <%=character_info.rankid%></p>
                    </div>
                  </div>
                  <div  id="health" style="flex-grow: 1; margin-left: 50px; display: flex; align-items: center;">
                    <div style="width: 200px; height: 14px; border-radius: 7px; background: linear-gradient(to right, #e74c3c, #e74c3c <%=character_info.health%>%, #f2f2f2 <%=character_info.health%>%, #f2f2f2); position: relative;">
                      <div style="width: <%=character_info.health%>%; height: 100%; border-radius: 7px; background-color: #e74c3c;"></div>
                      <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; font-size: 12px; color: white; font-weight: bold; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25); background-color: rgba(231, 76, 60, 0.2); border-radius: 7px;">
                        <i class="fas fa-heart" style="margin-right: 5px; color: white;"></i>
                        <%=character_info.health%>%
                      </div>
                    </div>
                  </div>
                  <p class="card-text" id="birth" style="margin-bottom: 5px; text-align: right; position: absolute; top: 10px; right: 10px;"><i class="fas fa-calendar-alt"></i> <%=character_info.borndate%></p>
                </div>
              </div>
              
              
              
              
              
              <div class="card" style="width: 25%; margin-bottom: 10px; margin-left: auto; background-color: #f8f8f8; padding: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center;">
                    <i class="fas fa-globe-americas" style="font-size: 56px; margin-right: 10px;"></i>
                    <p class="card-text" style="margin-bottom: 5px;">San Andreas Republic</p>
                  </div>
                </div>
              </div>
              
              
              <div class="card" style="width: 49.5%; margin-bottom: 10px; background-color: #f8f8f8; padding: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                <div class="card-body d-flex align-items-center">
                  <div class="icon-text" style="display: flex; align-items: center;">
                    <i class="fas fa-money-bill" style="font-size: 56px; margin-right: 10px;"></i>
                    <span style="font-size: 18px;">Gotówka: $<%=character_info.cash%></span>
                  </div>
                </div>
              </div>
              
              
              
              
              <div class="card" style="width: 49.5%; margin-bottom: 10px; margin-left: auto; background-color: #f8f8f8; padding: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                <div class="card-body">
                  <div class="icon-text" style="display: flex; align-items: center;">
                    <i class="fas fa-university" style="font-size: 56px; margin-right: 10px;"></i>
                    <span style="font-size: 18px;">Bank: $<%=character_info.bankcash%></span>
                  </div>
                </div>
              </div>

              <div class="card w-100" id="stats" style="height: 35%; border-radius: 8px; background-color: #f8f8f8; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;">
                  <div style="display: flex; align-items: center;">
                    <i class="fas fa-level-up-alt" style="font-size: 24px; margin-right: 10px;"></i>
                    <div>
                      <h5 class="card-title" style="margin-bottom: 5px; color: white; font-weight: bold; font-size: 18px;">Level <%=character_info.character_level%></h5>
                      <div style="width: 200px; height: 14px; border-radius: 7px; background-color: #f2f2f2; position: relative;">
                        <div style="width: <%=character_info.character_level_points%>%; height: 100%; border-radius: 7px; background-color: #3498db;"></div>
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; font-size: 12px; color: white; font-weight: bold; text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25);">
                          <%=character_info.exp%> XP
                        </div>
                      </div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center;">
                    <div style="margin-right: 10px;">
                      <i class="far fa-clock" style="font-size: 24px; color: white; margin-left: 8px;"></i>
                    </div>
                    <div>
                      <p class="card-text" style="margin-bottom: 5px; color: white;">Godziny postaci:</p>
                      <h5 class="card-title" style="margin-bottom: 5px; color: white; font-weight: bold; font-size: 18px;"><%=character_info.online_hours%>h <%=character_info.online_minutes%>m <%=character_info.online_seconds%>s</h5>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center;">
                    <div style="margin-right: 10px;">
                      <i class="far fa-file-text" style="font-size: 24px; color: white; margin-left: 8px;"></i>
                    </div>
                    <!-- <div>
                      <p class="card-text" style="margin-bottom: 5px; color: white;">Opis postaci:</p>
                      <p class="card-text" style="margin-bottom: 5px; color: white; font-weight: bold; font-size: 16px;"><%=character_info.Desc2%></p>
                    </div> -->
                  </div>
                  <div style="flex-grow: 1;"></div>
                  <div style="display: flex; align-items: center;">
                    <div style="margin-right: 10px;">
                          <i class="fas fa-cog" style="font-size: 24px; color: white; pointer-events: none;"></i>
                    </div>
                  </div>
                </div>
              </div>
            </div>   
          <% } %>
          <% if (req.query.type == "items") { %>
            <div class="table-container">
              <table class="table">
                <thead class="sticky-thead">
                  <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Przedmiot (nazwa)</th>
                    <th scope="col">Typ</th>
                    <th scope="col">Wartość 1</th>
                    <th scope="col">Wartość 2</th>
                    <th scope="col">Wartość 3</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <%items.forEach(item => {%>
                    <th scope="row"><%=item.uid%></th>
                    <td><%=item.name%></td>
                    <td><%=item.type%></td>
                    <td><%=item.value1%></td>
                    <td><%=item.value2%></td>
                    <td><%=item.value3%></td>
                    <%})%>
                  </tr>
                </tbody>
              </table>
            </div>
            <% } %>

            <% if (req.query.type == "vehicles") { %>
              <div class="table-container">
                <table class="table">
                  <thead class="sticky-thead">
                    <tr>
                      <th scope="col">ID</th>
                      <th scope="col">Pojazd</th>
                      <th scope="col">HP</th>
                      <th scope="col">Tablica</th>
                    </tr>
                  </thead>
                  <tbody>
                    <%vehicles.forEach((vehicle) => { %>
                    <tr>
                      <th scope="row" class="align-middle"><%=vehicle.uid%></th>
                      <td class="item-cell">
                        <div class="item-image-container">
                          <img src="/assets/dashboard/vehicles/Vehicle_<%=vehicle.modelid%>.jpg" alt="" class="item-image">
                        </div>
                      </td>
                      <th scope="row" class="align-middle"><%=vehicle.health%></th>
                      <td class="align-middle"><%=vehicle.numberplate%></td>
                    </tr>
                    <%})%>
                    
                  </tbody>
                </table>
              </div>
              <% } %>
              <% if (req.query.type === "admin" && req.session.admin > 0) { %>
                  <div class="row">
                    <div class="col-md-4">
                      <div class="custom-box warning-box text-center p-3">
                        <i class="fas fa-undo-alt box-icon"></i>
                        <h5 class="box-title">Resetowanie Pozycji</h5>
                        <div class="alert alert-warning mt-2">
                          <p><strong>Upewnij się, że gracz jest offline.</strong></p>
                          <form method="post" action="/acp/reset?id=<%=req.query.id%>">
                            <div class="form-group">
                              <select class="form-control" name="location" id="playerName">
                                <option value="" disabled selected>Wybierz spawn</option>
                                <option value="1">Spawn 1</option>
                              </select>
                            </div>
                            <button type="submit" class="btn btn-warning btn-block mt-2">
                              Zresetuj pozycję
                            </button>
                          </form>
                        </div>
                      </div>
                    </div>
                    <% if (character_info.char_active == 0) { %>
                      <div class="col-md-4">
                        <div class="custom-box block-box text-center p-3">
                          <i class="fas fa-lock box-icon"></i>
                          <h5 class="box-title">Blokowanie postaci</h5>
                          <div class="alert alert-warning mt-2">
                            <p><strong>Upewnij się, że wpisano poprawny powód.</strong></p>
                            <form method="post" action="/acp/block?id=<%=req.query.id%>">
                              <div class="form-group">
                                <input type="text" class="form-control" id="blockInput" name="reason" placeholder="Wprowadź powód blokady">
                              </div>
                              <button type="submit" class="btn btn-warning btn-block mt-2">
                                Zablokuj postać
                              </button>
                            </form>
                          </div>
                        </div>
                      </div>
                    <% } else if (character_info.char_active == 1) { %>
                      <div class="col-md-4">
                        <div class="custom-box blocked-box text-center p-3">
                          <i class="fas fa-lock box-icon"></i>
                          <h5 class="box-title">Postać jest zablokowana</h5>
                          <div class="alert alert-danger mt-2">
                            <p><strong>Administrator:</strong> <%= character_info.block_name %></p>
                            <p><strong>Powód:</strong> <%= character_info.block_reason %></p>
                            <form method="post" action="/acp/block?id=<%=req.query.id%>">
                              <button type="submit" class="btn btn-success btn-block mt-2">
                                Odblokuj
                              </button>
                            </form>
                          </div>
                        </div>
                      </div>
                    <% } %>
                    <!-- <div class="col-md-4">
                      <div class="custom-box warning-box text-center p-3">
                        <i class="fas fa-exclamation-triangle box-icon"></i>
                        <h5 class="box-title">Ostrzeżenie</h5>
                        <div class="alert alert-warning mt-2">
                          <p><strong>Upewnij się, że wpisano poprawny powód.</strong></p>
                          <form method="post" action="/acp/warn?id=<%=req.query.id%>">
                            <div class="form-group">
                              <input type="text" class="form-control" id="warningInput" name="reason" placeholder="Wprowadź powód ostrzeżenia">
                            </div>
                            <button type="submit" class="btn btn-warning btn-block mt-2">
                              Wyślij Ostrzeżenie
                            </button>
                          </form>
                        </div>
                      </div>
                    </div> -->
                  </div>
              <% } %>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  function toggleSidebar() {
    const sidebar = document.querySelector('.custom-sidebar');
    const birthDiv = document.getElementById('birth');
    if (window.innerWidth <= 767) {
      sidebar.style.display = 'none';
      birthDiv.style.removeProperty('right');
      
    } else {
      sidebar.style.display = 'block';
    }
  }
  window.addEventListener('load', toggleSidebar);
  window.addEventListener('resize', toggleSidebar);
</script>